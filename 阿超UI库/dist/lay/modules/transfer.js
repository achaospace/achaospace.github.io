/** byui-v2.5.4 MIT License By https://www.byui.com */
 ;byui.define(["laytpl","form"],function(e){"use strict";var t=byui.$,n=byui.laytpl,i=byui.form,a="transfer",r={config:{},index:byui[a]?byui[a].index+1e4:0,set:function(e){var n=this;return n.config=t.extend({},n.config,e),n},on:function(e,t){return byui.onevent.call(this,a,e,t)}},c=function(){var e=this,t=e.config,n=t.id||e.index;return c.that[n]=e,c.config[n]=t,{config:t,reload:function(t){e.reload.call(e,t)},getData:function(){return e.getData.call(e)}}},o="byui-hide",l="byui-btn-disabled",d="byui-none",s="byui-transfer-box",u="byui-transfer-header",h="byui-transfer-search",f="byui-transfer-active",y="byui-transfer-data",b=function(e){return e=e||{},['<div class="byui-transfer-box" data-index="'+e.index+'">','<div class="byui-transfer-header">','<input type="checkbox" name="'+e.checkAllName+'" lay-filter="layTransferCheckbox" lay-type="all" lay-skin="primary" title="{{ d.data.title['+e.index+"] || 'list"+(e.index+1)+"' }}\">","</div>","{{# if(d.data.showSearch){ }}",'<div class="byui-transfer-search">','<i class="byui-icon byui-icon-search"></i>','<input type="input" class="byui-input" placeholder="关键词搜索">',"</div>","{{# } }}",'<ul class="byui-transfer-data"></ul>',"</div>"].join("")},p=['<div class="byui-transfer byui-form byui-border-box" lay-filter="LAY-transfer-{{ d.index }}">',b({index:0,checkAllName:"layTransferLeftCheckAll"}),'<div class="byui-transfer-active">','<button type="button" class="byui-btn byui-btn-sm byui-btn-primary byui-btn-disabled" data-index="0">','<i class="byui-icon byui-icon-next"></i>',"</button>",'<button type="button" class="byui-btn byui-btn-sm byui-btn-primary byui-btn-disabled" data-index="1">','<i class="byui-icon byui-icon-prev"></i>',"</button>","</div>",b({index:1,checkAllName:"layTransferRightCheckAll"}),"</div>"].join(""),v=function(e){var n=this;n.index=++r.index,n.config=t.extend({},n.config,r.config,e),n.render()};v.prototype.config={title:["列表一","列表二"],width:200,height:360,data:[],value:[],showSearch:!1,id:"",text:{none:"无数据",searchNone:"无匹配数据"}},v.prototype.reload=function(e){var n=this;byui.each(e,function(e,t){t.constructor===Array&&delete n.config[e]}),n.config=t.extend(!0,{},n.config,e),n.render()},v.prototype.render=function(){var e=this,i=e.config,a=e.elem=t(n(p).render({data:i,index:e.index})),r=i.elem=t(i.elem);r[0]&&(i.data=i.data||[],i.value=i.value||[],e.key=i.id||e.index,r.html(e.elem),e.layBox=e.elem.find("."+s),e.layHeader=e.elem.find("."+u),e.laySearch=e.elem.find("."+h),e.layData=a.find("."+y),e.layBtn=a.find("."+f+" .byui-btn"),e.layBox.css({width:i.width,height:i.height}),e.layData.css({height:function(){return i.height-e.layHeader.outerHeight()-e.laySearch.outerHeight()-2}()}),e.renderData(),e.events())},v.prototype.renderData=function(){var e=this,t=(e.config,[{checkName:"layTransferLeftCheck",views:[]},{checkName:"layTransferRightCheck",views:[]}]);e.parseData(function(e){var n=e.selected?1:0,i=["<li>",'<input type="checkbox" name="'+t[n].checkName+'" lay-skin="primary" lay-filter="layTransferCheckbox" title="'+e.title+'"'+(e.disabled?" disabled":"")+(e.checked?" checked":"")+' value="'+e.value+'">',"</li>"].join("");t[n].views.push(i),delete e.selected}),e.layData.eq(0).html(t[0].views.join("")),e.layData.eq(1).html(t[1].views.join("")),e.renderCheckBtn()},v.prototype.renderForm=function(e){i.render(e,"LAY-transfer-"+this.index)},v.prototype.renderCheckBtn=function(e){var n=this,i=n.config;e=e||{},n.layBox.each(function(a){var r=t(this),c=r.find("."+y),d=r.find("."+u).find('input[type="checkbox"]'),s=c.find('input[type="checkbox"]'),h=0,f=!1;if(s.each(function(){var e=t(this).data("hide");(this.checked||this.disabled||e)&&h++,this.checked&&!e&&(f=!0)}),d.prop("checked",f&&h===s.length),n.layBtn.eq(a)[f?"removeClass":"addClass"](l),!e.stopNone){var b=c.children("li:not(."+o+")").length;n.noneView(c,b?"":i.text.none)}}),n.renderForm("checkbox")},v.prototype.noneView=function(e,n){var i=t('<p class="byui-none">'+(n||"")+"</p>");e.find("."+d)[0]&&e.find("."+d).remove(),n.replace(/\s/g,"")&&e.append(i)},v.prototype.setValue=function(){var e=this,n=e.config,i=[];return e.layBox.eq(1).find("."+y+' input[type="checkbox"]').each(function(){var e=t(this).data("hide");e||i.push(this.value)}),n.value=i,e},v.prototype.parseData=function(e){var n=this,i=n.config,a=[];return byui.each(i.data,function(n,r){r=("function"==typeof i.parseData?i.parseData(r):r)||r,a.push(r=t.extend({},r)),byui.each(i.value,function(e,t){t==r.value&&(r.selected=!0)}),e&&e(r)}),i.data=a,n},v.prototype.getData=function(e){var t=this,n=t.config,i=[];return byui.each(e||n.value,function(e,t){byui.each(n.data,function(e,n){delete n.selected,t==n.value&&i.push(n)})}),i},v.prototype.events=function(){var e=this,n=e.config;e.elem.on("click",'input[lay-filter="layTransferCheckbox"]+',function(){var n=t(this).prev(),i=n[0].checked,a=n.parents("."+s).eq(0).find("."+y);n[0].disabled||("all"===n.attr("lay-type")&&a.find('input[type="checkbox"]').each(function(){this.disabled||(this.checked=i)}),e.renderCheckBtn({stopNone:!0}))}),e.layBtn.on("click",function(){var i=t(this),a=i.data("index"),r=e.layBox.eq(a),c=[];if(!i.hasClass(l)){e.layBox.eq(a).each(function(n){var i=t(this),a=i.find("."+y);a.children("li").each(function(){var n=t(this),i=n.find('input[type="checkbox"]'),a=i.data("hide");i[0].checked&&!a&&(i[0].checked=!1,r.siblings("."+s).find("."+y).append(n.clone()),n.remove(),c.push(i[0].value)),e.setValue()})}),e.renderCheckBtn();var o=r.siblings("."+s).find("."+h+" input");""===o.val()||o.trigger("keyup"),n.onchange&&n.onchange(e.getData(c),a)}}),e.laySearch.find("input").on("keyup",function(){var i=this.value,a=t(this).parents("."+h).eq(0).siblings("."+y),r=a.children("li");r.each(function(){var e=t(this),n=e.find('input[type="checkbox"]'),a=n[0].title.indexOf(i)!==-1;e[a?"removeClass":"addClass"](o),n.data("hide",!a)}),e.renderCheckBtn();var c=r.length===a.children("li."+o).length;e.noneView(a,c?n.text.searchNone:"")})},c.that={},c.config={},r.reload=function(e,t){var n=c.that[e];return n.reload(t),c.call(n)},r.getData=function(e){var t=c.that[e];return t.getData()},r.render=function(e){var t=new v(e);return c.call(t)},e(a,r)});